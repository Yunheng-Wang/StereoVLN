# 全局batch_size 为  batch_size * GPU_NUM * grad_accumulation_steps

main:
  batch_size: 2
  save_root: "log/"
  dtype: "bf16"
  image_size: 448
  training_epoch: 3   # (episodes <648629> * epoch_num) / (batch_size * GPU_NUM * grad_accumulation_steps) 
  cpu_workers_num: 8
  prediction_steps: 4
  history_steps: 8
  valid_depth: 5
  data_root: "/home/CONNECT/yfang870/yunhengwang/StereoVLN/data/cache"

  gradient:
    grad_clip_norm: 0.5  # 梯度裁剪
    grad_accumulation_steps: 1  # 梯度累计



training:
  optimizer:
    lr: 3.0e-5
    weight_decay: 0.0
    betas: [0.9, 0.999]
    eps: 1.0e-8
  scheduler:
    type: "cosine"
    warmup_ratio: 0.075  
    min_lr_ratio: 0.1

  weight_pointsloss: 0.1
  weight_depthloss: 0.1
  weight_languageloss: 1.0



model:
  dim: 2048
  vlm:
    max_tokens: 4096 # vision tokens: 2756
    vlm_checkpoints_path: "/home/CONNECT/yfang870/yunhengwang/StereoVLN/model/base/InternVL3_5-2B"
  foundationstereo:
    foundationstereo_checkpoints_path: "/home/CONNECT/yfang870/yunhengwang/StereoVLN/model/base/FoundationStereo/checkpoints/23-51-11"
  pointhead:
    mlp_ratio: 0.5
    dropout: 0.1



